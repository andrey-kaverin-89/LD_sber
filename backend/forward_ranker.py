import re
import pandas as pd
from pymystem3 import Mystem
from gensim.models import Word2Vec
# from sklearn.neighbors import NearestNeighbors
# import nltk
from nltk import word_tokenize
from nltk.corpus import stopwords
# import random
# from tqdm import tqdm
import joblib


def stemming(tokens: list) -> pd.Series:
    stem = Mystem()
    tokens = [word_tokenize("".join(stem.lemmatize(sentence))) for sentence in tokens]
    tokens = [[word for word in sentence if len(word) > 2] for sentence in tokens]
    #     tokens = [
    #         [
    #             word
    #             for word in sentence
    #             if morph.parse(word)[0].tag.POS == "NOUN"
    #             or morph.parse(word)[0].tag.POS == "ADJF"
    #         ]
    #         for sentence in tokens
    #     ]
    return tokens


def check_stopwords(text: pd.Series) -> pd.Series:
    result = [
        [word for word in sentence if word not in stopwords.words("russian") and word != " "]
        for sentence in text
    ]
    return result


def get_mail(text):
    nnn = joblib.load('Kneighbours.pkl')
    model = Word2Vec.load('w2v_model.pkl')
    emails = pd.DataFrame(['Ocheretny.A.S@sberbank.ru',
 'AChertok@sberbank.ru',
 'AChertok@sberbank.ru',
 'Ocheretny.A.S@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Galitskiy.I.O@sberbank.ru',
 'AChertok@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Udovichenko.K.Dm@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Denisov.I.Vya@omega.sbrf.ru',
 'Denisov.I.Vya@omega.sbrf.ru',
 'AChertok@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'AChertok@sberbank.ru',
 'AChertok@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Udovichenko.K.Dm@omega.sbrf.ru',
 'AChertok@sberbank.ru',
 'Kozlovtseva.E.Ale@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Shavrina.T.O@sberbank.ru',
 'Bagnenko.V.V@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'koshelev.r.v@omega.sbrf.ru',
 'Krivobok.M.A@sberbank.ru',
 'Shavrina.T.O@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Gazaryan.E.Gar@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Kaunov.S.A@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Kaunov.S.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Shavrina.T.O@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'Gazaryan.E.Gar@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Kozlovtseva.E.Ale@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Starostenko.E.S@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'AVStrelnikov@sberbank.ru',
 'Starostenko.E.S@sberbank.ru',
 'Galitskiy.I.O@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Smirnov.I.Yurye@sberbank.ru',
 'Galitskiy.I.O@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Galitskiy.I.O@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Galitskiy.I.O@sberbank.ru',
 'Zibarev.L.I@sberbank.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Krivobok.M.A@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'eoshipovalova@sberbank.ru',
 'Protopopov.V.Al@sberbank.ru',
 'Chesakov.D.G@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Aksenov.S.An@sberbank.ru',
 'Gaparkhoev.V.L@omega.sbrf.ru',
 'KABut1@sberbank.ru',
 'KABut1@sberbank.ru',
 'Fedotov.I.Ser@omega.sbrf.ru',
 'KABut1@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Dmitrieva.Ann.And@omega.sbrf.ru',
 'Kryuchkova.A.Vy@sberbank.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'kondratieva@vbudushee.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'kondratieva@vbudushee.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'kondratieva@vbudushee.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Podryadchikova.M.V@omega.sbrf.ru',
 'Dmitrieva.Ann.And@omega.sbrf.ru',
 'Dmitrieva.Ann.And@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Starostenko.E.S@sberbank.ru',
 'Churin.D.R@sberbank.ru',
 'Podryadchikova.M.V@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@omega.sbrf.ru',
 'Bregeda.M.V@sberbank.ru',
 'Bregeda.M.V@sberbank.ru',
 'Bregeda.M.V@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Babchenkov.V.Ig@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'Fazilov.R.Er@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'Tumanov.A.L@sberbank.ru',
 'Ivashneva.L.A@omega.sbrf.ru',
 'Boyuka.P.A@omega.sbrf.ru',
 'kondratieva@vbudushee.ru',
 'kondratieva@vbudushee.ru',
 'kondratieva@vbudushee.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'kondratieva@vbudushee.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Krylova.D.An@omega.sbrf.ru',
 'Krylova.D.An@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'AVStrelnikov@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Bagnenko.V.V@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Alekseev.D.Genna@omega.sbrf.ru',
 'Alekseev.D.Genna@sberbank.ru',
 'Alekseev.D.Genna@sberbank.ru',
 'Bagnenko.V.V@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'Tumanov.A.L@sberbank.ru',
 'Tumanov.A.L@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'Alekseev.D.Genna@omega.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Tumanov.A.L@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'AVStrelnikov@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Altunbaev.R.Ma@omega.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'AVStrelnikov@sberbank.ru',
 'Protopopov.V.Al@sberbank.ru',
 'Altunbaev.R.Ma@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Altunbaev.R.Ma@sberbank.ru',
 'Alekseev.D.Genna@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Maslov.P.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Starostenko.E.S@sberbank.ru',
 'Starostenko.E.S@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Skryabina.A.M@sberbank.ru',
 'Skryabina.A.M@sberbank.ru',
 'Starostenko.E.S@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Starostenko.E.S@sberbank.ru',
 'EAGarbuzova@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Eremenko-MA@mail.ca.sbrf.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'Starostenko.E.S@sberbank.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Alekseev.D.Genna@omega.sbrf.ru',
 'Gaparkhoev.V.L@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'Babchenkov.V.Ig@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'koshelev.r.v@omega.sbrf.ru',
 'Denisov.I.Vya@sberbank.ru',
 'Alekseev.D.Genna@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Smirnov.I.Yurye@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'sanaeviv@yandex.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'LVTemin@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'Onuchin.S.Mi@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Ocheretny.A.S@sberbank.ru',
 'Gorbunova.N.An@sberbank.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Gaparkhoev.V.L@sberbank.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Nakipov.I.Na@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Eremenko-MA@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Gaparkhoev.V.L@omega.sbrf.ru',
 'Antonova.A.Anatolyev@sberbank.ru',
 'Mogilevskiy.L.Ig@omega.sbrf.ru',
 'Gorbolskaya.U.O@sberbank.ru',
 'Gorbolskaya.U.O@sberbank.ru',
 'Gorbolskaya.U.O@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Gorbolskaya.U.O@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Gaparkhoev.V.L@sberbank.ru',
 'Denisov.I.Vya@omega.sbrf.ru',
 'konyrevdmitriy@gmail.com',
 'Gorbolskaya.U.O@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Antonova.A.Anatolyev@sberbank.ru',
 'Antonova.A.Anatolyev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Akhmetov.A.Y@sberbank.ru',
 'konyrevdmitriy@gmail.com',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'KABut1@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Antonova.A.Anatolyev@sberbank.ru',
 'Buldashov.A.Va@omega.sbrf.ru',
 'Aksenov.S.An@sberbank.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Denisov.I.Vya@omega.sbrf.ru',
 'Denisov.I.Vya@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Kozlov.V.Vladimi@omega.sbrf.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Buldashov.A.Va@omega.sbrf.ru',
 'Aleksandrov.S.Vladim@omega.sbrf.ru',
 'Gelevskaya-GI@mail.ca.sbrf.ru',
 'Gelevskaya-GI@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Kozlov.V.Vladimi@omega.sbrf.ru',
 'Kozlov.V.Vladimi@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Kozlovtseva.E.Ale@omega.sbrf.ru',
 'Averbakh.V@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Averbakh.V@sberbank.ru',
 'Krivobok.M.A@sberbank.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'Gaparkhoev.V.L@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'EAGarbuzova@sberbank.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'eoshipovalova@sberbank.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Poteryaev.V.Al@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Denisov.I.Vya@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Aksenov.S.An@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Milashova.E.V@sberbank.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Poteryaev.V.Al@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Ananyev.I.Vla@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Poteryaev.V.Al@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'AVStrelnikov@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Tsutsiev.D.E@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'ca.sberbank@ru.fcm.travel',
 'Yusupov.V.A@omega.sbrf.ru',
 'Aksenov.S.An@sberbank.ru',
 'Kuvshinov.A.Aleks@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Timofeev.A.Valery@sberbank.ru',
 'Timofeev.A.Valery@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Nakipov.I.Na@sberbank.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Timofeev.A.Valery@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Tutunov.B.M@sberbank.ru',
 'Milashova.E.V@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Obrezkov.D.Ale@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Tutunov.B.M@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Zibarev.L.I@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'Zibarev.L.I@sberbank.ru',
 'Shtuntsayger.I.Ef@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Sanaev.I.Ev@omega.sbrf.ru',
 'Krivobok.M.A@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'KABut1@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Karpets.M.Val@omega.sbrf.ru',
 'Karpets.M.Val@omega.sbrf.ru',
 'MikhSBelkin@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'olyoleynik@sberbank.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'yellow.sniff.97@gmail.com',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'OUT-Dmitrieva-AA@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'OUT-Smirnov-IY1@mail.ca.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Ustinov.A.Yury@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Temin-LV@mail.ca.sbrf.ru',
 'Karpets.M.Val@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'LVTemin@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'DABerestnev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Protopopov.V.Al@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Krivobok.M.A@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Bregeda.M.V@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Krivobok.M.A@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Kakushkin.M.N@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Timofeev.A.Valery@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'SMUsova@sberbank.ru',
 'Churin.D.R@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'gaparkhoev.v.l@omega.sbrf.ru',
 'Gaparkhoev.V.L@sberbank.ru',
 'Kakushkin.M.N@omega.sbrf.ru',
 'Churin.D.R@omega.sbrf.ru',
 'Bukvich.M.Ni@sberbank.ru',
 'Yantsen.S.Va@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Dyuzhikov.D.Ko@omega.sbrf.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Protopopov.V.Al@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Averbakh.V@sberbank.ru',
 'Fedorova.M.Valer@omega.sbrf.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Sanaev.I.Ev@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'igborfomin@mail.ru',
 'Babchenkov.V.Ig@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Averbakh.V@sberbank.ru',
 'Averbakh.V@sberbank.ru',
 'NRZelinskiy@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Marakhovskaya.M.S@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Aksenov.Ser.Vla@sberbank.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'Zhirkova.Y.V@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Malkova.I.V@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Aksenov.S.An@sberbank.ru',
 'Sanaev.I.Ev@omega.sbrf.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'AVStrelnikov@sberbank.ru',
 'Averbakh.V@sberbank.ru',
 'Burlakova.M.Val@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'Aksenov.S.An@sberbank.ru',
 'Karpets.M.Val@omega.sbrf.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Kozlovtseva.E.Ale@sberbank.ru',
 'Tutunov.B.M@omega.sbrf.ru',
 'Aksenov.S.An@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Yusupov.V.A@omega.sbrf.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Kudryavtcev-MYU@mail.ca.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.A@mail.ca.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'Garbuzova.El.An@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Burlakova.M.Val@omega.sbrf.ru',
 'MAEremenko@sberbank.ru',
 'Nakipov.I.Na@omega.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'MYUKudryavtcev@sberbank.ru',
 'Konyrev.D.An@omega.sbrf.ru',
 'OUT-Dmitrieva-AA@mail.ca.sbrf.ru',
 'Protopopov.V.Al@omega.sbrf.ru',
 'Burlakova.M.Val@sberbank.ru'],columns=['to_clean'])
    vectors = []
    s = pd.Series(text)
    s = s.apply(lambda x: re.sub('[0-9]+', '', x))
    s = s.apply(lambda x: re.sub('[^а-яА-Я]+', ' ', x))
    s = s.apply(lambda x: x.lower())
    s = stemming(s)
    s = check_stopwords(s)
    text = s[0]

    for word in text:
        try:
            vectors.append(model.wv.get_vector(word))
        except:
            #             print(word)
            pass
    if len(vectors) != 0:
        text = (sum(vectors) / len(vectors))

    else:

        text = [None for _ in range(50)]
    dist = nnn.kneighbors(text.reshape(1, -1))[0]
    ids = nnn.kneighbors(text.reshape(1, -1))[1]
    email = emails['to_clean'][ids.flatten()]
    return email.tolist()